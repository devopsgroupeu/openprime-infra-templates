additionalPrometheusRulesMap:
  servicesrule:
    groups:
    - name: node_cpu_usage_greater_than_90_percent
      rules:
      - expr: 100 - (avg by (instance) (rate(node_cpu_seconds_total{job="node-exporter",mode="idle"}[1m])) * 100) > 90
        alert: node_cpu_usage_greater_than_90_percent
        labels:
          severity: "warning"
        for: 15m
        annotations:
          summary: "Node cpu usage for instance {{ $labels.instance }} is greater than 90%."
    - name: node_free_memory_less_than_2_GB
      rules:
      - expr: (node_memory_MemFree_bytes + node_memory_Buffers_bytes + node_memory_Cached_bytes)/1000000000 < 2
        alert: node_free_memory_less_than_2_GB
        for: 15m
        labels:
          severity: "warning"
        annotations:
          summary: "Node free memory for instance {{ $labels.instance }} is less than 2GB."
    - name: active_connection_count_more_than_100
      rules:
      - expr: aws_applicationelb_active_connection_count_sum > 100
        alert: active_connection_count_more_than_100
        for: 15m
        labels:
          severity: "warning"
        annotations:
          summary: "Activne connection from clients to the load balancer and from the load balancer to targets is more than 100"
    - name: HTTPCode_elb_4XX_count_more_than_20
      rules:
      - expr: aws_applicationelb_httpcode_elb_4_xx_count_average > 20
        alert: HTTPCode_elb_4XX_count_more_than_20
        for: 15m
        labels:
          severity: "warning"
        annotations:
          summary: "HTTP 4XX client error is more than 20"
    - name: HTTPCode_elb_5XX_count_more_than_20
      rules:
      - expr: aws_applicationelb_httpcode_elb_5_xx_count_average > 20
        alert: HTTPCode_elb_5XX_count_more_than_20
        for: 15m
        labels:
          severity: "warning"
        annotations:
          summary: "HTTP 5XX server error is more than 20"
    - name: rejected_connection_count_more_than_10
      rules:
      - expr: aws_applicationelb_rejected_connection_count_sum > 10
        alert: rejected_connection_count_more_than_10
        for: 15m
        labels:
          severity: "warning"
        annotations:
          summary: "Rejected connection is more than 10"
    - name: healthy_host_count_more_than_100
      rules:
      - expr: aws_applicationelb_healthy_host_count_average > 100
        alert: healthy_host_count_more_than_100
        for: 15m
        labels:
          severity: "warning"
        annotations:
          summary: "Targets that are considered healthy is more than 100"
    - name: HTTPCode_target_4XX_count_more_than_20
      rules:
      - expr: aws_applicationelb_httpcode_target_4_xx_count_average > 20
        alert: HTTPCode_target_4XX_count_more_than_20
        for: 15m
        labels:
          severity: "warning"
        annotations:
          summary: "HTTP 4xx response codes generated by the targets is more than 20"
    - name: HTTPCode_target_5XX_count_more_than_20
      rules:
      - expr: aws_applicationelb_httpcode_target_5_xx_count_average > 20
        alert: HTTPCode_target_5XX_count_more_than_20
        for: 15m
        labels:
          severity: "warning"
        annotations:
          summary: "HTTP 5xx response codes generated by the targets is more than 20"
    - name: target_connection_error_count_more_than_5
      rules:
      - expr: aws_applicationelb_target_connection_error_count_sum > 5
        alert: target_connection_error_count_more_than_5
        for: 15m
        labels:
          severity: "warning"
        annotations:
          summary: "Connections that were not successfully established between the load balancer and target is more than 5."
    - name: target_response_time_more_than_3s
      rules:
      - expr: aws_applicationelb_target_response_time_average > 3
        alert: target_response_time_more_than_3s
        for: 15m
        labels:
          severity: "warning"
        annotations:
          summary: "The time elapsed after the request leaves the load balancer until a response from the target is received is more than 3."
    - name: unhealthy_host_count_more_than_5
      rules:
      - expr: aws_applicationelb_unhealthy_host_count_average > 5
        alert: unhealthy_host_count_more_than_5
        for: 15m
        labels:
          severity: "warning"
        annotations:
          summary: "Targets that are considered unhealthy is more than 5."
